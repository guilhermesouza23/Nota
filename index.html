
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nota de Serviço</title>
    <style>
        body {
         
            font-family: Arial, sans-serif;
        }

        #header {
            text-align: center;
            padding: 20px 0;
        }

        #header h1 {
            margin: 0;
        }

        #services {
            text-align: center;
            margin-top: 20px;
        }

        #address {
            text-align: center;
            margin-top: 20px;
        }

        #line {
            border-top: 1px solid #000;
            margin: 20px 0;
        }

        @media print {
            #services,
            #line,
            #address {
                display: none;
            }

            body {
                text-align: left;
            }

            #header {
                text-align: left;
            }

            #serviceForm {
                margin: 20px;
            }

            .imprimir-botao {
                display: none;
            }
        }

        /* Ajuste do layout do endereço */
        #endereco {
            width: 100%;
            box-sizing: border-box;
        }

        /* Ajuste para campos verticalmente abaixo um do outro */
        #serviceForm label {
            display: block;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>JOSEMAG Reforma de Máquinas Agrícolas Ltda</h1>
    </div>

    <div id="services">
        <li>Serviço de Torno</li>
        <li>Serviço de Soldas</li>
        <li>Reforma de Implementos em Geral</li>
    </div>

    <div id="address">
        <p>Endereço: Av. Francisco Dias de Castro, 975 - Carmo de Minas - MG</p>
        <p>Tel. Loja: (35) 3334-1120 - Tel. Residencial: (35) 3334-1431</p>
    </div>

    <div id="line"></div>

    <form id="serviceForm">
        <label for="cliente">Nome:</label>
        <input type="text" id="cliente" name="cliente" required>

        <label for="data">Data:</label>
        <input type="text" id="data" name="data" required>

        <label for="endereco">Endereço:</label>
        <textarea id="endereco" name="endereco" rows="2" required></textarea>

        <div id="line"></div>

        <table>
            <thead>
                <tr>
                    <th>Tipo de Serviço Prestado</th>
                    <th>Preço</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody id="servicosTableBody"></tbody>
        </table>

        <div id="line"></div>

        <p>Total: R$ <span id="total">0.00</span></p>

        <button type="button" class="imprimir-botao" onclick="adicionarServico()">Adicionar Serviço</button>
        <button type="button" class="imprimir-botao" onclick="imprimirNota()">Imprimir Nota</button>
    </form>

    <script>
        function adicionarServico() {
            const tipoServico = prompt("Informe o tipo de serviço:");
            const preco = parseFloat(prompt("Informe o preço do serviço:").replace(',', '.'));

            if (!isNaN(preco)) {
                const servicosTableBody = document.getElementById('servicosTableBody');
                const newRow = servicosTableBody.insertRow();
                const tipoServicoCell = newRow.insertCell(0);
                const precoCell = newRow.insertCell(1);
                const acoesCell = newRow.insertCell(2);

                tipoServicoCell.textContent = tipoServico;
                precoCell.textContent = `R$ ${preco.toFixed(2)}`;
                acoesCell.innerHTML = '<button type="button" onclick="removerServico(this)">Remover</button>';

                // Atualizar o total
                const totalElement = document.getElementById('total');
                const totalAtual = parseFloat(totalElement.textContent.replace('R$ ', ''));
                totalElement.textContent = `R$ ${(totalAtual + preco).toFixed(2)}`;
            } else {
                alert('Por favor, insira um preço válido.');
            }
        }

        function removerServico(button) {
            const row = button.parentNode.parentNode;
            const preco = parseFloat(row.cells[1].textContent.replace('R$ ', ''));

            // Atualizar o total
            const totalElement = document.getElementById('total');
            const totalAtual = parseFloat(totalElement.textContent.replace('R$ ', ''));
            totalElement.textContent = `R$ ${(totalAtual - preco).toFixed(2)}`;

            // Remover a linha
            row.parentNode.removeChild(row);
        }
        function imprimirNota() {
    // Obter dados do formulário
    const data = document.getElementById('data').value;
    const cliente = document.getElementById('cliente').value;
    const endereco = document.getElementById('endereco').value;

    // Obter dados dos serviços
    const servicosTableBody = document.getElementById('servicosTableBody');
    const rows = servicosTableBody.querySelectorAll('tr');
    const servicos = [];

    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        const tipoServico = cells[0].textContent;
        const preco = parseFloat(cells[1].textContent.replace('R$ ', ''));
        servicos.push({ tipoServico, preco });
    });

    // Calcular o total
    const total = servicos.reduce((acc, servico) => acc + servico.preco, 0);

    // Construir a nota formatada
    const notaFormatada = `
        JOSEMAG Reforma de Máquinas Agrícolas Ltda

        Endereço: Av. Francisco Dias de Castro, 975 - Carmo de Minas - MG
        Tel. Loja: (35) 3334-1120 - Tel. Residencial: (35) 3334-1431
        <hr>
        Serviços Prestados:
        ${servicos.map(servico => `- ${servico.tipoServico} : R$ ${servico.preco.toFixed(2)}`).join('\n')}
        <hr>
        Total: R$ ${total.toFixed(2)}
        <hr>
        Dados do Cliente:
        
        Data: ${data}
        Nome: ${cliente}
        Endereço: ${endereco}
    `;

    // Exibir o conteúdo da nota em um alerta ou imprimir na página
    alert(notaFormatada);

    // Criar uma janela para impressão
    const printWindow = window.open('', '_blank');
    printWindow.document.write('<html><head><title>Nota de Serviço</title></head><body>');
    printWindow.document.write(`<pre>${notaFormatada}</pre>`);
    printWindow.document.write('</body></html>');
    printWindow.document.close();

    // Imprimir automaticamente
    printWindow.print();
}
</script>
</body>
</html>
